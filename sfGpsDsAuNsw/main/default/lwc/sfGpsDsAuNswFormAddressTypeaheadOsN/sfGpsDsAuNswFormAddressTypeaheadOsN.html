<template>
  <div class="omni-typeahead-container">
    <c-sf-gps-ds-au-nsw-typeahead-os-n
      class={computedTypeaheadClass}
      type="text"
      field-level-help={mergedHelpText}
      field-level-help-position={_propSetMap.helpTextPos}
      label={mergedLabel}
      onblur={handleBlur}
      onlastitemclick={enterEditMode}
      onselect={handleSelect}
      onclear={handleClear}
      icon-name-right="utility:empty"
      options={options}
      placeholder={_placeholder}
      required={_propSetMap.required}
      min-length={_propSetMap.minLength}
      max-length={_propSetMap.maxLength}
      required-label={allCustomLabelsUtil.OmniRequired}
      message-when-value-missing={_messageWhenValueMissing}
      message-when-too-short={_messageWhenTooShort}
      message-when-too-long={_messageWhenTooLong}
      theme="sfgpsds"
      value={elementValueLabel}
      remote-source={_useRemoteSource}
      disable-filter={_disableFilter}
      data-omni-input
    >
      <div slot="iconRight">
        <span
          class="has-text-link cannot-find-address label-link"
          role="button"
          onclick={handleToggle}
        >
          Enter address manually
        </span>
        <button
          if:false={_propSetMap.hideEditButton}
          class="slds-button slds-button_icon nds-button nds-button_icon"
          aria-expanded={_isEditMode}
          onclick={toggleEditMode}
        >
          <omnistudio-icon
            icon-name="utility:edit"
            extraclass="slds-button__icon nds-button__icon"
            size="x-small"
            theme={_theme}
            alternative-text={_editLabel}
          >
          </omnistudio-icon>
        </button>
      </div>

      <a
        slot="lastItem"
        if:true={_propSetMap.newItemLabel}
        label={_propSetMap.newItemLabel}
        >{_propSetMap.newItemLabel}
      </a>
    </c-sf-gps-ds-au-nsw-typeahead-os-n>

    <template if:false={isSmart}>
      <div class="nsw-form__group">
        <div class="sfgpsds-label__group">
          <div class="sfgpsds-label__group_label_container">
            <div if:true={_propSetMap.label} class="sfgpsds-label__group_label">
              <label
                class={computedLabelClassName}
                aria-label={label}
                for="address"
              >
                {mergedLabel}
                <span if:true={_propSetMap.required} class="sr-only">
                  ({allCustomLabelsUtil.OmniRequired})</span
                >
              </label>
            </div>
          </div>

          <div class="sfgpsds-label__group_action">
            <div>
              <span
                class="has-text-link cannot-find-address label-link"
                role="button"
                onclick={handleToggle}
              >
                Smart address lookup
              </span>

              <button
                if:false={_propSetMap.hideEditButton}
                class="slds-button slds-button_icon nds-button nds-button_icon"
                aria-expanded={_isEditMode}
                onclick={toggleEditMode}
              >
                <omnistudio-icon
                  icon-name="utility:edit"
                  extraclass="slds-button__icon nds-button__icon"
                  size="x-small"
                  theme={_theme}
                  alternative-text={_editLabel}
                >
                </omnistudio-icon>
              </button>
            </div>
          </div>
        </div>

        <span if:true={fieldLevelHelp} id="helper" class="nsw-form__helper">
          {fieldLevelHelp}
        </span>

        <div class="nsw-grid">
          <div class="nsw-col nsw-col-12 street">
            <c-sf-gps-ds-au-nsw-input-os-n
              type="text"
              name="street"
              class=""
              label="Street Address"
              onblur={handleFieldBlur}
              required={_propSetMap.required}
              required-label={allCustomLabelsUtil.OmniRequired}
              field-level-help=""
              placeholder=""
              value={street}
            >
            </c-sf-gps-ds-au-nsw-input-os-n>
          </div>

          <div class="nsw-col nsw-col-md-6 nsw-col-12 suburb">
            <c-sf-gps-ds-au-nsw-input-os-n
              type="text"
              name="suburb"
              class=""
              label="Suburb"
              onblur={handleFieldBlur}
              required={_propSetMap.required}
              required-label={allCustomLabelsUtil.OmniRequired}
              field-level-help=""
              placeholder=""
              value={suburb}
            >
            </c-sf-gps-ds-au-nsw-input-os-n>
          </div>

          <div class="nsw-col nsw-col-md-3 nsw-col-6 state">
            <c-sf-gps-ds-au-nsw-combobox-os-n
              options={states}
              label="State"
              required={_propSetMap.required}
              required-label={allCustomLabelsUtil.OmniRequired}
              onchange={handleStateBlur}
              theme="nswds"
              value={state}
              field-level-help=""
              data-show-lookup="true"
              message-when-value-missing={_messageWhenValueMissing}
              searchable="true"
            >
            </c-sf-gps-ds-au-nsw-combobox-os-n>
          </div>

          <div class="nsw-col nsw-col-md-3 nsw-col-6 postalcode">
            <c-sf-gps-ds-au-nsw-input-os-n
              type="text"
              name="postcode"
              class=""
              label="Postcode"
              onblur={handleFieldBlur}
              required={_propSetMap.required}
              required-label={allCustomLabelsUtil.OmniRequired}
              field-level-help=""
              placeholder=""
              min-length="4"
              max-length="4"
              value={postcode}
            >
            </c-sf-gps-ds-au-nsw-input-os-n>
          </div>

          <div class="nsw-col nsw-col-12 country">
            <c-sf-gps-ds-au-nsw-input-os-n
              type="text"
              name="country"
              class=""
              label="Country"
              onblur={handleFieldBlur}
              required={_propSetMap.required}
              required-label={allCustomLabelsUtil.OmniRequired}
              field-level-help=""
              placeholder=""
              value={country}
              read-only="true"
            >
            </c-sf-gps-ds-au-nsw-input-os-n>
          </div>
        </div>
      </div>
    </template>

    <!--
    <div if:true={errorMessage}
      class="slds-has-error nds-has-error">
      <span class="slds-form-element__help nds-form-element__help nds-form-element__help_text-transform__none">{errorMessage}</span>
    </div>
    -->

    <span
      if:true={errorMessage}
      class={computedHelperClassName}
      aria-live="assertive"
      id="errorMessageBlock"
    >
      <span
        if:true={computedStatusIcon}
        class="material-icons nsw-material-icons"
        aria-hidden="true"
      >
        {computedStatusIcon}
      </span>
      {errorMessage}
    </span>
  </div>
</template>
